---
import verses from "../data/verses.json";

interface Props {
  totalPosts?: number;
  totalThemes?: number;
}

const { totalPosts = 0, totalThemes = 0 } = Astro.props;

function hashDay(day: number, mod: number) {
  const x = Math.sin(day * 12.9898) * 43758.5453;
  return Math.floor((x - Math.floor(x)) * mod);
}

const dayNumber = Math.floor(Date.now() / 86400000);
let verseIndex = hashDay(dayNumber, verses.length);
const previousIndex = hashDay(dayNumber - 1, verses.length);

if (verseIndex === previousIndex && verses.length > 1) {
  verseIndex = (verseIndex + 1) % verses.length;
}

const verse = verses[verseIndex];
---

<section class="relative overflow-hidden py-20 text-center sm:py-32">
  <div
    class="absolute inset-0 -z-10 bg-[radial-gradient(45%_45%_at_50%_50%,rgba(59,130,246,0.08)_0%,transparent_100%)]"
  >
  </div>

  <div class="mx-auto max-w-4xl px-6 space-y-8">
    <h1 class="text-5xl font-extrabold tracking-tight text-text sm:text-7xl">
      Caf&eacute; <span class="text-primary">Com F&eacute;</span>
    </h1>

    <p class="mx-auto max-w-2xl text-lg leading-8 text-text-muted sm:text-xl">
      Um espaco para unir programação e fé. Aqui, o café alimenta o código e a
      fe sustenta o proposito.
    </p>

    <div
      class="flex flex-wrap items-center justify-center gap-3 text-xs font-semibold text-text-muted"
    >
      <span class="rounded-full border border-border bg-surface px-4 py-2">
        {totalPosts} posts publicados
      </span>
      <span class="rounded-full border border-border bg-surface px-4 py-2">
        {totalThemes} temas para explorar
      </span>
    </div>

    <div class="mt-10 flex items-center justify-center gap-x-6">
      <a
        href="#blog"
        class="rounded-full bg-primary px-8 py-4 text-sm font-bold text-white shadow-lg hover:bg-primary-dark transition-all transform hover:scale-105 cursor-pointer"
      >
        Ler posts
      </a>
      <a
        href="#missao"
        class="text-sm font-semibold leading-6 text-text hover:underline"
      >
        Nossa missao <span aria-hidden="true">-></span>
      </a>
    </div>
  </div>
</section>

<div class="mx-auto max-w-2xl px-6 pb-20">
  <div
    class="rounded-2xl border border-border/50 bg-card/40 p-8 backdrop-blur-md text-center shadow-sm"
  >
    <span
      class="text-[10px] font-black uppercase tracking-[0.2em] text-primary/80"
    >
      Palavra do Dia
    </span>
    <blockquote class="mt-6">
      <p
        class="text-xl font-medium italic text-text sm:text-2xl leading-relaxed"
      >
        "{verse.text}"
      </p>
      <footer class="mt-6 text-sm font-semibold text-text-muted/70">
        - {verse.ref}
      </footer>
    </blockquote>
  </div>
</div>
